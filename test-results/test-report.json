{
  "timestamp": "2025-06-13T16:24:11.501Z",
  "config": {
    "type": "integration",
    "coverage": false,
    "verbose": false,
    "outputDir": "./test-results"
  },
  "results": [
    {
      "suite": "Integration Tests - API",
      "success": false,
      "duration": 1638,
      "output": "\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/appointments.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nðŸ§ª Iniciando suite de tests...\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n  Appointments API Integration ...\n    POST /api/appointments/create ...\n      should create appointment with valid data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should reject invalid appointment data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle missing required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle malformed JSON ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(7ms)\u001b[0m\n      should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle room conflicts ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    POST /api/appointments/create ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(9ms)\u001b[0m\n    GET /api/appointments ...\n      should return list of appointments ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle pagination parameters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle filter parameters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle date range filters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    GET /api/appointments ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    PUT /api/appointments/[id]/update ...\n      should update appointment status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle invalid status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle non-existent appointment ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle unauthorized update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle invalid appointment data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle concurrent updates ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    PUT /api/appointments/[id]/update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    DELETE /api/appointments/[id]/delete ...\n      should delete appointment successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle non-existent appointment ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle unauthorized deletion ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle appointment with active session ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    DELETE /api/appointments/[id]/delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    Error Handling ...\n      should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle invalid request format ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle missing content type ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle rate limiting ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle service unavailable ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    Error Handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  Appointments API Integration ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(13ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nâœ… Tests completados\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(15ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/auth.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nðŸ§ª Iniciando suite de tests...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n  Auth API Integration ...\n    POST /api/auth/login ...\n      should login with valid credentials ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should reject invalid credentials ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle missing email ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle missing password ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(7ms)\u001b[0m\n      should handle malformed JSON ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle missing content type ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle rate limiting ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle account lockout ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle inactive user account ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    POST /api/auth/login ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(11ms)\u001b[0m\n    GET /api/auth/check ...\n      should return user data for authenticated request ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle logout flow ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    GET /api/auth/check ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    Error Handling ...\n      should handle session validation errors gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle network errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    Error Handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  Auth API Integration ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(12ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nâœ… Tests completados\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(13ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/patients-real.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nðŸ§ª Iniciando suite de tests...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n  Patients API Integration (Real) ...\n    GET /api/patients ...\n      should return empty list when no patients exist ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should return empty list when no patients exist ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(69ms)\u001b[0m\n      should return list of patients when they exist ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should return list of patients when they exist ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(17ms)\u001b[0m\n      should handle unauthorized access ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle unauthorized access ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(14ms)\u001b[0m\n    GET /api/patients ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 3 failed steps) \u001b[0m\u001b[38;5;245m(101ms)\u001b[0m\n    POST /api/patients ...\n      should create a new patient successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should create a new patient successfully ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(15ms)\u001b[0m\n      should reject patient with missing required fields ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should reject patient with missing required fields ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(15ms)\u001b[0m\n      should reject patient with invalid email format ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should reject patient with invalid email format ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(15ms)\u001b[0m\n      should reject patient with duplicate email ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should reject patient with duplicate email ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(21ms)\u001b[0m\n      should handle malformed JSON ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle malformed JSON ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(14ms)\u001b[0m\n    POST /api/patients ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 5 failed steps) \u001b[0m\u001b[38;5;245m(81ms)\u001b[0m\n    GET /api/patients/[id] ...\n      should return specific patient by ID ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should return specific patient by ID ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(13ms)\u001b[0m\n      should return 404 for non-existent patient ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should return 404 for non-existent patient ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(16ms)\u001b[0m\n    GET /api/patients/[id] ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(29ms)\u001b[0m\n    PUT /api/patients/[id] ...\n      should update patient successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should update patient successfully ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(13ms)\u001b[0m\n      should return 404 when updating non-existent patient ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should return 404 when updating non-existent patient ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(12ms)\u001b[0m\n    PUT /api/patients/[id] ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(25ms)\u001b[0m\n    DELETE /api/patients/[id] ...\n      should delete patient successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should delete patient successfully ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(13ms)\u001b[0m\n      should return 404 when deleting non-existent patient ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should return 404 when deleting non-existent patient ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(13ms)\u001b[0m\n    DELETE /api/patients/[id] ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(26ms)\u001b[0m\n    GET /api/patients/by-psychologist/[email] ...\n      should return patients for specific psychologist ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should return patients for specific psychologist ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(16ms)\u001b[0m\n      should return empty list for psychologist with no patients ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCould not authenticate user for tests: Error: Failed to authenticate user: 404\n    at authenticateUser (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/helpers/integration.ts:120:11)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts:30:20)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:339:9)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n    at async innerWrapped (ext:cli/40_test.js:180:5)\n    at async exitSanitizer (ext:cli/40_test.js:96:27)\n    at async Object.outerWrapped [as fn] (ext:cli/40_test.js:123:14)\n    at async TestContext.step (ext:cli/40_test.js:481:22)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should return empty list for psychologist with no patients ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(13ms)\u001b[0m\n    GET /api/patients/by-psychologist/[email] ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(29ms)\u001b[0m\n  Patients API Integration (Real) ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 6 failed steps) \u001b[0m\u001b[38;5;245m(293ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nâœ… Tests completados\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(295ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/patients.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nðŸ§ª Iniciando suite de tests...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n  Patients API Integration Tests ...\n    POST /api/patients/create ...\n      should create patient with valid data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should reject invalid patient data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(9ms)\u001b[0m\n      should handle missing required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle duplicate email ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle malformed JSON ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle rate limiting ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle validation errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    POST /api/patients/create ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(11ms)\u001b[0m\n    GET /api/patients ...\n      should return list of patients ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle pagination parameters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle search filters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle empty results ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    GET /api/patients ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    GET /api/patients/[id] ...\n      should return patient details ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle non-existent patient ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle invalid patient ID format ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    GET /api/patients/[id] ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    PUT /api/patients/[id]/update ...\n      should update patient successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle non-existent patient ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle invalid update data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle unauthorized update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle concurrent updates ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle email conflict on update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    PUT /api/patients/[id]/update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    DELETE /api/patients/[id]/delete ...\n      should delete patient successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle non-existent patient ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle unauthorized deletion ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle patient with active appointments ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    DELETE /api/patients/[id]/delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    Error Handling ...\n      should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle invalid request format ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle missing content type ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle service unavailable ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle timeout errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    Error Handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  Patients API Integration Tests ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(16ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nâœ… Tests completados\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(19ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/rooms.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nðŸ§ª Iniciando suite de tests...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n  Rooms API Integration Tests ...\n    DELETE /api/rooms/[id]/delete ...\n      should delete room successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle non-existent room ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(7ms)\u001b[0m\n      should handle unauthorized deletion ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should prevent deletion of room with active appointments ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    DELETE /api/rooms/[id]/delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(9ms)\u001b[0m\n    POST /api/rooms/[id]/toggle-availability ...\n      should toggle room availability successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle non-existent room ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle invalid room ID ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    POST /api/rooms/[id]/toggle-availability ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    GET /api/rooms ...\n      should return list of rooms ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle filter parameters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle pagination ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    GET /api/rooms ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    POST /api/rooms/create ...\n      should create room successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should validate required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle duplicate room ID ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle malformed JSON ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle unauthorized creation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    POST /api/rooms/create ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    PUT /api/rooms/[id]/update ...\n      should update room successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle non-existent room ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should validate update data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    PUT /api/rooms/[id]/update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    Error Handling ...\n      should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle invalid request methods ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle missing content type ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle rate limiting ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle service unavailable ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    Error Handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  Rooms API Integration Tests ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(14ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nâœ… Tests completados\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(16ms)\u001b[0m\n\n\u001b[0m\u001b[1m\u001b[37m\u001b[41m ERRORS \u001b[0m\n\nglobal ... Patients API Integration (Real) ... GET /api/patients ... should return empty list when no patients exist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... GET /api/patients ... should return list of patients when they exist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m97\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... GET /api/patients ... should handle unauthorized access \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError\n    throw new AssertionError(msg);\n\u001b[0m\u001b[31m          ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assert\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert.ts\u001b[0m:\u001b[0m\u001b[33m17\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massert\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m608\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m120\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should create a new patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   201\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m140\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should reject patient with missing required fields \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   400\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m161\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should reject patient with invalid email format \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   400\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m181\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should reject patient with duplicate email \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   201\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m201\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should handle malformed JSON \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   400\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m224\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... GET /api/patients/[id] ... should return specific patient by ID \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   201\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m246\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... GET /api/patients/[id] ... should return 404 for non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: SyntaxError: Unexpected token '<', \"<!DOCTYPE \"... is not valid JSON\n      const data = await response.json();\n\u001b[0m\u001b[31m                   ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mparse\u001b[0m (\u001b[0m\u001b[36m<anonymous>\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mpackageData\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m421\u001b[0m:\u001b[0m\u001b[33m14\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mconsumeBody\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m274\u001b[0m:\u001b[0m\u001b[33m12\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m270\u001b[0m:\u001b[0m\u001b[33m20\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... PUT /api/patients/[id] ... should update patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: SyntaxError: Unexpected token '<', \"<!DOCTYPE \"... is not valid JSON\n      const createdPatient = await createResponse.json();\n\u001b[0m\u001b[31m                             ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mparse\u001b[0m (\u001b[0m\u001b[36m<anonymous>\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mpackageData\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m421\u001b[0m:\u001b[0m\u001b[33m14\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mconsumeBody\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m274\u001b[0m:\u001b[0m\u001b[33m12\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m291\u001b[0m:\u001b[0m\u001b[33m30\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... PUT /api/patients/[id] ... should return 404 when updating non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: SyntaxError: Unexpected token '<', \"<!DOCTYPE \"... is not valid JSON\n      const data = await response.json();\n\u001b[0m\u001b[31m                   ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mparse\u001b[0m (\u001b[0m\u001b[36m<anonymous>\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mpackageData\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m421\u001b[0m:\u001b[0m\u001b[33m14\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mconsumeBody\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m274\u001b[0m:\u001b[0m\u001b[33m12\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m322\u001b[0m:\u001b[0m\u001b[33m20\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... DELETE /api/patients/[id] ... should delete patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: SyntaxError: Unexpected token '<', \"<!DOCTYPE \"... is not valid JSON\n      const createdPatient = await createResponse.json();\n\u001b[0m\u001b[31m                             ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mparse\u001b[0m (\u001b[0m\u001b[36m<anonymous>\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mpackageData\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m421\u001b[0m:\u001b[0m\u001b[33m14\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mconsumeBody\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m274\u001b[0m:\u001b[0m\u001b[33m12\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m343\u001b[0m:\u001b[0m\u001b[33m30\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... DELETE /api/patients/[id] ... should return 404 when deleting non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: SyntaxError: Unexpected token '<', \"<!DOCTYPE \"... is not valid JSON\n      const data = await response.json();\n\u001b[0m\u001b[31m                   ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mparse\u001b[0m (\u001b[0m\u001b[36m<anonymous>\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mpackageData\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m421\u001b[0m:\u001b[0m\u001b[33m14\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mconsumeBody\u001b[0m (\u001b[0m\u001b[36mext:deno_fetch/22_body.js\u001b[0m:\u001b[0m\u001b[33m274\u001b[0m:\u001b[0m\u001b[33m12\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m371\u001b[0m:\u001b[0m\u001b[33m20\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... GET /api/patients/by-psychologist/[email] ... should return patients for specific psychologist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m417\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... Patients API Integration (Real) ... GET /api/patients/by-psychologist/[email] ... should return empty list for psychologist with no patients \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   404\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m436\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\n\u001b[0m\u001b[1m\u001b[37m\u001b[41m FAILURES \u001b[0m\n\nglobal ... Patients API Integration (Real) ... GET /api/patients ... should return empty list when no patients exist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... GET /api/patients ... should return list of patients when they exist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... GET /api/patients ... should handle unauthorized access \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should create a new patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should reject patient with missing required fields \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should reject patient with invalid email format \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should reject patient with duplicate email \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... POST /api/patients ... should handle malformed JSON \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... GET /api/patients/[id] ... should return specific patient by ID \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... GET /api/patients/[id] ... should return 404 for non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... PUT /api/patients/[id] ... should update patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... PUT /api/patients/[id] ... should return 404 when updating non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... DELETE /api/patients/[id] ... should delete patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... DELETE /api/patients/[id] ... should return 404 when deleting non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... GET /api/patients/by-psychologist/[email] ... should return patients for specific psychologist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... Patients API Integration (Real) ... GET /api/patients/by-psychologist/[email] ... should return empty list for psychologist with no patients \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\n\u001b[0m\u001b[31mFAILED\u001b[0m | 4 passed (121 steps) | 1 failed (23 steps) \u001b[0m\u001b[38;5;245m(598ms)\u001b[0m\n\n\nErrors:\n\u001b[0m\u001b[32mCheck\u001b[0m file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/appointments.test.ts\n\u001b[0m\u001b[32mCheck\u001b[0m file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/auth.test.ts\n\u001b[0m\u001b[32mCheck\u001b[0m file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\n\u001b[0m\u001b[32mCheck\u001b[0m file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients.test.ts\n\u001b[0m\u001b[32mCheck\u001b[0m file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/rooms.test.ts\nListening on http://127.0.0.1:51423/\nListening on http://127.0.0.1:51425/\nListening on http://127.0.0.1:51427/\nListening on http://127.0.0.1:51429/\nListening on http://127.0.0.1:51431/\nListening on http://127.0.0.1:51433/\nListening on http://127.0.0.1:51435/\nListening on http://127.0.0.1:51437/\nListening on http://127.0.0.1:51439/\nListening on http://127.0.0.1:51441/\nListening on http://127.0.0.1:51443/\nListening on http://127.0.0.1:51445/\nListening on http://127.0.0.1:51447/\nListening on http://127.0.0.1:51449/\nListening on http://127.0.0.1:51451/\nListening on http://127.0.0.1:51453/\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: Test failed\n"
    }
  ],
  "summary": {
    "totalSuites": 1,
    "successfulSuites": 0,
    "failedSuites": 1,
    "totalDuration": 1638
  }
}