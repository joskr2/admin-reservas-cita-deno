{
  "timestamp": "2025-06-13T18:27:38.240Z",
  "config": {
    "type": "all",
    "coverage": false,
    "verbose": false,
    "outputDir": "./test-results"
  },
  "results": [
    {
      "suite": "Unit Tests - Repositories",
      "success": false,
      "duration": 606,
      "output": "\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/unit/repositories/appointment.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nðŸ§ª Configurando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n  AppointmentRepository ...\n    create ...\n      should create a new appointment ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(109ms)\u001b[0m\n      should fail to create appointment with invalid data ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nInvalid appointment data provided to create: {\n  id: \"\",\n  psychologistEmail: \"\",\n  appointmentDate: \"\",\n  appointmentTime: \"\"\n}\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n      should fail to create appointment with invalid data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(9ms)\u001b[0m\n      should set default status to scheduled ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(5ms)\u001b[0m\n    create ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(123ms)\u001b[0m\n    update ...\n      should update an existing appointment ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(6ms)\u001b[0m\n      should update appointment time ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(4ms)\u001b[0m\n      should return false for non-existent appointment ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(18ms)\u001b[0m\n    delete ...\n      should delete an appointment ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(34ms)\u001b[0m\n      should return false for non-existent appointment ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(34ms)\u001b[0m\n    validation ...\n      should reject appointment with malformed data ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nInvalid appointment data provided to create: { id: 123, psychologistEmail: {}, appointmentDate: [] }\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n      should reject appointment with malformed data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    validation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAppointmentsByDate ...\n      should return appointments for a specific date ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(15ms)\u001b[0m\n    getAppointmentsByDate ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(15ms)\u001b[0m\n    getAppointmentsByPsychologist ...\n      should return appointments for a specific psychologist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAppointmentsByPsychologist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAppointmentsByStatus ...\n      should return appointments with a specific status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAppointmentsByStatus ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAll ...\n      should return all appointments ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAll ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n  AppointmentRepository ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(197ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nâœ… Limpiando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(198ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/unit/repositories/patient.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nðŸ§ª Configurando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n  PatientRepository ...\n    create ...\n      should create a new patient successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n      should generate ID if not provided ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should add timestamps on creation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should validate required fields ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid patient data provided to create: {\n  id: \"test-id\",\n  name: \"\",\n  isActive: true,\n  createdAt: \"2025-06-13T18:27:28.193Z\",\n  updatedAt: \"2025-06-13T18:27:28.193Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should validate name is string ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid patient data provided to create: {\n  id: \"42525a51-603f-412e-9fe2-98e650c187f6\",\n  name: null,\n  email: \"patient-1749839248194@example.com\",\n  phone: \"123456789\",\n  isActive: true,\n  createdAt: \"2025-06-13T18:27:28.194Z\",\n  updatedAt: \"2025-06-13T18:27:28.194Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate name is string ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should validate isActive is boolean ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid patient data provided to create: {\n  id: \"f097e1d6-7a13-48dc-af3e-6bbd65398360\",\n  name: \"Test Patient\",\n  email: \"patient-1749839248195@example.com\",\n  phone: \"123456789\",\n  isActive: \"true\",\n  createdAt: \"2025-06-13T18:27:28.195Z\",\n  updatedAt: \"2025-06-13T18:27:28.195Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate isActive is boolean ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    create ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(6ms)\u001b[0m\n    getById ...\n      should return patient when ID exists ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should return null when ID does not exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    getById ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getPatientByName ...\n      should return patients with matching name ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(3ms)\u001b[0m\n      should return exact match ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(3ms)\u001b[0m\n      should be case insensitive ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(3ms)\u001b[0m\n      should return empty array when no matches ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle invalid name parameter ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid name provided to getPatientByName: \nInvalid name provided to getPatientByName: null\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle invalid name parameter ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    getPatientByName ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(11ms)\u001b[0m\n    getAllPatientsAsProfiles ...\n      should return all patients as profiles ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(14ms)\u001b[0m\n      should return sorted profiles ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return empty array when no patients exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAllPatientsAsProfiles ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(16ms)\u001b[0m\n    searchPatients ...\n      should search by name ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should search by email ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should search by phone ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should search partial matches ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should be case insensitive ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return all patients when query is empty ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return empty array when no matches ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    searchPatients ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(8ms)\u001b[0m\n    getActivePatients ...\n      should return only active patients ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return empty array when no active patients ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getActivePatients ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n    update ...\n      should update patient successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should update name index when name changes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(3ms)\u001b[0m\n      should return false when updating non-existent patient ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should preserve other fields when updating ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(5ms)\u001b[0m\n    delete ...\n      should delete patient successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should remove from name index when deleted ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n      should return false when deleting non-existent patient ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(3ms)\u001b[0m\n    getAll ...\n      should return all patients ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return empty array when no patients exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    getAll ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    validation ...\n      should validate name is required ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid patient data provided to create: {\n  id: \"999933f8-0db7-46e5-a107-9891f489f7bb\",\n  name: \"\",\n  email: \"patient-1749839248248@example.com\",\n  phone: \"123456789\",\n  isActive: true,\n  createdAt: \"2025-06-13T18:27:28.248Z\",\n  updatedAt: \"2025-06-13T18:27:28.248Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate name is required ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should validate name is string ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid patient data provided to create: {\n  id: \"b28d76f8-2eaf-47e5-8922-df6103449281\",\n  name: 123,\n  email: \"patient-1749839248248@example.com\",\n  phone: \"123456789\",\n  isActive: true,\n  createdAt: \"2025-06-13T18:27:28.248Z\",\n  updatedAt: \"2025-06-13T18:27:28.248Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate name is string ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should validate isActive is boolean ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid patient data provided to create: {\n  id: \"befcce1e-551c-484d-b677-95c248d961ec\",\n  name: \"Test Patient\",\n  email: \"patient-1749839248248@example.com\",\n  phone: \"123456789\",\n  isActive: \"true\",\n  createdAt: \"2025-06-13T18:27:28.248Z\",\n  updatedAt: \"2025-06-13T18:27:28.248Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate isActive is boolean ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    validation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    error handling ...\n      should handle malformed data gracefully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid patient data provided to create: {\n  id: \"test-id\",\n  name: null,\n  isActive: \"not-boolean\",\n  createdAt: \"invalid-date\",\n  updatedAt: \"2025-06-13T18:27:28.249Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle malformed data gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    error handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  PatientRepository ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(60ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nâœ… Limpiando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(62ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/unit/repositories/room.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nðŸ§ª Configurando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n  RoomRepository ...\n    create ...\n      should create a new room successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n      should create room with generated ID ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should validate required fields ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: {\n  id: \"test-id\",\n  name: \"\",\n  capacity: 2,\n  isAvailable: true,\n  equipment: [],\n  createdAt: \"2025-06-13T18:27:28.295Z\",\n  updatedAt: \"2025-06-13T18:27:28.295Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n      should validate ID field ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: {\n  id: \"\",\n  name: \"Test Room\",\n  capacity: 2,\n  isAvailable: true,\n  equipment: [ \"projector\", \"whiteboard\" ],\n  createdAt: \"2025-06-13T18:27:28.296Z\",\n  updatedAt: \"2025-06-13T18:27:28.296Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate ID field ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should validate capacity is positive number ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: {\n  id: \"caf4571a-0ca0-4229-9adc-cac345e116db\",\n  name: \"Test Room\",\n  capacity: -1,\n  isAvailable: true,\n  equipment: [ \"projector\", \"whiteboard\" ],\n  createdAt: \"2025-06-13T18:27:28.296Z\",\n  updatedAt: \"2025-06-13T18:27:28.296Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate capacity is positive number ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should add timestamps on creation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    create ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(6ms)\u001b[0m\n    getById ...\n      should return room when ID exists ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return null when ID does not exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    getById ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAvailableRooms ...\n      should return only available rooms for given date and time ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return empty array when no available rooms ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAvailableRooms ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n    updateAvailability ...\n      should update room availability ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should toggle back to available ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return false when room does not exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    updateAvailability ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n    update ...\n      should update room successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return false when updating non-existent room ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should preserve other fields when updating ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(4ms)\u001b[0m\n    update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(5ms)\u001b[0m\n    delete ...\n      should delete room successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return true when deleting non-existent room ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAll ...\n      should return all rooms ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return empty array when no rooms exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAll ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n    initializeDefaultRooms ...\n      should initialize default rooms ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nSala por defecto creada: Sala A - Terapia Individual\nSala por defecto creada: Sala B - Terapia Familiar\nSala por defecto creada: Sala C - Terapia de Grupo\nSala por defecto creada: Sala D - EvaluaciÃ³n\nSala por defecto creada: Sala E - RelajaciÃ³n\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should initialize default rooms ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should not duplicate rooms if already exist ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nSalas ya inicializadas, omitiendo creaciÃ³n de salas por defecto\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should not duplicate rooms if already exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    initializeDefaultRooms ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n    validation ...\n      should validate name is required ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: {\n  id: \"cf1a76de-1265-49de-aae2-bc8be1416d85\",\n  name: \"\",\n  capacity: 2,\n  isAvailable: true,\n  equipment: [ \"projector\", \"whiteboard\" ],\n  createdAt: \"2025-06-13T18:27:28.313Z\",\n  updatedAt: \"2025-06-13T18:27:28.313Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate name is required ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should validate capacity is positive ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: {\n  id: \"69a4c027-76d7-4443-8e60-6b59bd6cc958\",\n  name: \"Test Room\",\n  capacity: 0,\n  isAvailable: true,\n  equipment: [ \"projector\", \"whiteboard\" ],\n  createdAt: \"2025-06-13T18:27:28.313Z\",\n  updatedAt: \"2025-06-13T18:27:28.313Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate capacity is positive ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should validate equipment is array ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: {\n  id: \"54393c8d-680d-485f-8393-92cbbfacb194\",\n  name: \"Test Room\",\n  capacity: 2,\n  isAvailable: true,\n  equipment: \"not-an-array\",\n  createdAt: \"2025-06-13T18:27:28.314Z\",\n  updatedAt: \"2025-06-13T18:27:28.314Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate equipment is array ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should validate isAvailable is boolean ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: {\n  id: \"df6e2f1f-bd4d-4cec-8a04-030c7aace332\",\n  name: \"Test Room\",\n  capacity: 2,\n  isAvailable: \"true\",\n  equipment: [ \"projector\", \"whiteboard\" ],\n  createdAt: \"2025-06-13T18:27:28.314Z\",\n  updatedAt: \"2025-06-13T18:27:28.314Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate isAvailable is boolean ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should validate ID is string ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: {\n  id: 123,\n  name: \"Test Room\",\n  capacity: 2,\n  isAvailable: true,\n  equipment: [ \"projector\", \"whiteboard\" ],\n  createdAt: \"2025-06-13T18:27:28.314Z\",\n  updatedAt: \"2025-06-13T18:27:28.314Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate ID is string ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    validation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n    edge cases ...\n      should handle concurrent room operations ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle malformed room data gracefully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: { id: \"test-room\", name: \"Test Room\" }\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle malformed room data gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle database errors gracefully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid room data provided to create: {\n  id: null,\n  name: \"Test Room\",\n  capacity: 2,\n  isAvailable: true,\n  equipment: [ \"projector\", \"whiteboard\" ],\n  createdAt: \"2025-06-13T18:27:28.316Z\",\n  updatedAt: \"2025-06-13T18:27:28.316Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle database errors gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    edge cases ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n  RoomRepository ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(25ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nâœ… Limpiando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(27ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/unit/repositories/session.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nðŸ§ª Configurando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n  SessionRepository ...\n    createSession ...\n      should create session successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(9ms)\u001b[0m\n      should reject invalid session ID ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should reject invalid user email ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle database errors ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nError creating session session-123: Error: Database error\n    at Object.getInstance (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts:91:43)\n    at SessionRepository.getKv (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/lib/database/repositories/session.ts:22:34)\n    at SessionRepository.createSession (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/lib/database/repositories/session.ts:43:29)\n    at file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts:98:31\n    at Module.assertRejects (https://deno.land/std@0.216.0/assert/assert_rejects.ts:71:29)\n    at assertRejects (https://deno.land/std@0.216.0/testing/asserts.ts:478:24)\n    at Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts:97:13)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:358:16)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:33)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:33)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle database errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    createSession ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(12ms)\u001b[0m\n    getSession ...\n      should return session when found ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return null when session not found ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should return null for expired sessions ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle database errors gracefully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nError getting session session-123: Error: Database connection failed\n    at Object.getInstance (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts:177:26)\n    at SessionRepository.getKv (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/lib/database/repositories/session.ts:22:34)\n    at SessionRepository.getSession (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/lib/database/repositories/session.ts:60:29)\n    at Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts:182:44)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:358:16)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:33)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:33)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle database errors gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getSession ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n    deleteSession ...\n      should delete session successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle non-existent session deletion ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle invalid session ID gracefully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid sessionId provided to deleteSession: \n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle invalid session ID gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    deleteSession ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    cleanExpiredSessions ...\n      should clean expired sessions successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nCleaned 1 expired sessions\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should clean expired sessions successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle cleanup errors gracefully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nError cleaning expired sessions: Error: List failed\n    at Object.getInstance (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts:263:43)\n    at SessionRepository.getKv (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/lib/database/repositories/session.ts:22:34)\n    at SessionRepository.cleanExpiredSessions (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/lib/database/repositories/session.ts:97:29)\n    at Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts:270:29)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:358:16)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:33)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:33)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle cleanup errors gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    cleanExpiredSessions ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    extendSession ...\n      should extend session successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should return false for non-existent session ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    extendSession ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    getAllActiveSessions ...\n      should return active sessions ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should return empty array when no sessions found ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should handle database errors gracefully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nError getting all active sessions: Error: Database error\n    at Object.getInstance (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts:369:43)\n    at SessionRepository.getKv (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/lib/database/repositories/session.ts:22:34)\n    at SessionRepository.getAllActiveSessions (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/lib/database/repositories/session.ts:155:29)\n    at Object.<anonymous> (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts:374:44)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:358:16)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:33)\n    at TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:33)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async TestSuiteInternal.runTest (https://deno.land/std@0.216.0/testing/_test_suite.ts:346:9)\n    at async fn (https://deno.land/std@0.216.0/testing/_test_suite.ts:316:13)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should handle database errors gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    getAllActiveSessions ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    Edge Cases ...\n      should handle malformed session data ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should handle concurrent session operations ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    Edge Cases ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(3ms)\u001b[0m\n  SessionRepository ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(20ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nâœ… Limpiando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(20ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/unit/repositories/user.test.ts\u001b[0m\nglobal ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nðŸ§ª Configurando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n  UserRepository ...\n    create ...\n      should create a new user successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(10ms)\u001b[0m\n      should generate ID if not provided ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should add timestamps on creation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should validate required fields ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid user data provided to create: {\n  id: \"test-id\",\n  email: \"\",\n  name: \"Test User\",\n  role: \"psychologist\",\n  passwordHash: \"hashedpassword\",\n  isActive: true,\n  createdAt: \"2025-06-13T18:27:28.403Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n      should validate email format ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n      should validate unique email ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    create ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(16ms)\u001b[0m\n    getUserById ...\n      should return user when ID exists ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should return null when ID does not exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getUserById ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getUserByEmail ...\n      should return user when email exists ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should return null when email does not exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should be case insensitive ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getUserByEmail ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n    getUsersByRole ...\n      should return users with specific role ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return empty array when no users with role ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getUsersByRole ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n    getAllUsersAsProfiles ...\n      should return all users as profiles ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    getAllUsersAsProfiles ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    update ...\n      should update user successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should update role index when role changes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n      should return false when updating non-existent user ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should preserve other fields when updating ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(4ms)\u001b[0m\n    delete ...\n      should delete user successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should remove from role index when deleted ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n      should return false when deleting non-existent user ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(3ms)\u001b[0m\n    getAll ...\n      should return all users ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should return empty array when no users exist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    getAll ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    validation ...\n      should validate email is required ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid user data provided to create: {\n  id: \"bb154ce8-b568-46aa-8d57-9d6ce9a26d7e\",\n  email: \"\",\n  name: \"Test User\",\n  role: \"psychologist\",\n  passwordHash: \"hashedpassword123\",\n  isActive: true,\n  createdAt: \"2025-06-13T18:27:28.421Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate email is required ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n      should validate role is valid ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nInvalid user data provided to create: {\n  id: \"2aa3d74e-af73-4572-9ba7-1884761f46eb\",\n  email: \"test-1749839248422@example.com\",\n  name: \"Test User\",\n  role: \"\",\n  passwordHash: \"hashedpassword123\",\n  isActive: true,\n  createdAt: \"2025-06-13T18:27:28.422Z\"\n}\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n      should validate role is valid ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n      should validate name is required ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    validation ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n  UserRepository ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 3 failed steps) \u001b[0m\u001b[38;5;245m(32ms)\u001b[0m\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nâœ… Limpiando entorno de testing...\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\nglobal ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(33ms)\u001b[0m\n\n\u001b[0m\u001b[1m\u001b[37m\u001b[41m ERRORS \u001b[0m\n\nglobal \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:191:10\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: Leaks detected:\n  - \"database\" was created during the test, but not cleaned up during the test. Close the resource before the end of the test.\n\nglobal \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:191:10\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: Leaks detected:\n  - \"database\" was created during the test, but not cleaned up during the test. Close the resource before the end of the test.\n\nglobal \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:191:10\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: Leaks detected:\n  - \"database\" was created during the test, but not cleaned up during the test. Close the resource before the end of the test.\n\nglobal ... SessionRepository ... Edge Cases ... should handle malformed session data \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   {\u001b[22m\u001b[39m\n\u001b[31m\u001b[1m-     userEmail: undefined,\u001b[22m\u001b[39m\n\u001b[31m\u001b[1m-   }\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   null\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/session.test.ts\u001b[0m:\u001b[0m\u001b[33m402\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... UserRepository ... create ... should validate email format \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   true\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   false\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/user.test.ts\u001b[0m:\u001b[0m\u001b[33m97\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... UserRepository ... create ... should validate unique email \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   true\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   false\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/user.test.ts\u001b[0m:\u001b[0m\u001b[33m106\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... UserRepository ... getUserByEmail ... should be case insensitive \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   undefined\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   \"test@example.com\"\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/user.test.ts\u001b[0m:\u001b[0m\u001b[33m148\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nglobal ... UserRepository ... validation ... should validate name is required \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   true\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   false\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/unit/repositories/user.test.ts\u001b[0m:\u001b[0m\u001b[33m325\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\n\u001b[0m\u001b[1m\u001b[37m\u001b[41m FAILURES \u001b[0m\n\nglobal \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:191:10\u001b[0m\nglobal \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:191:10\u001b[0m\nglobal \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:191:10\u001b[0m\nglobal ... SessionRepository ... Edge Cases ... should handle malformed session data \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... UserRepository ... create ... should validate email format \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... UserRepository ... create ... should validate unique email \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... UserRepository ... getUserByEmail ... should be case insensitive \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nglobal ... UserRepository ... validation ... should validate name is required \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\n\u001b[0m\u001b[31mFAILED\u001b[0m | 0 passed (166 steps) | 5 failed (11 steps) \u001b[0m\u001b[38;5;245m(473ms)\u001b[0m\n\n\nErrors:\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: Test failed\n"
    },
    {
      "suite": "Unit Tests - Components",
      "success": true,
      "duration": 112,
      "output": "\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/unit/components/ui/Button.test.tsx\u001b[0m\nButton Component ...\n  props validation ...\n    should have correct default props ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    should accept all valid variants ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should accept all valid sizes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should accept all valid types ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  props validation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  className generation ...\n    should generate base classes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should have variant-specific classes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should have size-specific classes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  className generation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  component structure ...\n    should be a function component ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should accept children prop ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should accept onClick handler ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle disabled state ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle loading state ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  component structure ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  accessibility ...\n    should support ARIA attributes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should have proper focus management ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  accessibility ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  form integration ...\n    should work with form submission ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should work with form reset ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  form integration ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  event handling ...\n    should handle click events ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    should prevent events when disabled ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  event handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  styling consistency ...\n    should have consistent transition classes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should have consistent spacing classes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should have consistent color classes ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  styling consistency ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\nButton Component ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(10ms)\u001b[0m\n\n\u001b[0m\u001b[32mok\u001b[0m | 1 passed (28 steps) | 0 failed \u001b[0m\u001b[38;5;245m(11ms)\u001b[0m\n\n"
    },
    {
      "suite": "Unit Tests - Utils",
      "success": true,
      "duration": 112,
      "output": "\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/unit/utils/appointmentUtils.test.ts\u001b[0m\nAppointmentUtils ...\n  getStatusColor ...\n    should return correct color for pending status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return correct color for scheduled status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    should return correct color for in_progress status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return correct color for completed status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return correct color for cancelled status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return default color for unknown status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  getStatusColor ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  getStatusText ...\n    should return correct text for pending status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return correct text for scheduled status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return correct text for in_progress status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return correct text for completed status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return correct text for cancelled status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return default text for unknown status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  getStatusText ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  getNextStatuses ...\n    should return correct next statuses for pending ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return correct next statuses for scheduled ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return correct next statuses for in_progress ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return empty array for completed status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return empty array for cancelled status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should return empty array for unknown status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  getNextStatuses ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  status workflow validation ...\n    should validate complete workflow from pending to completed ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should allow cancellation from any active status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should not allow transitions from terminal statuses ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  status workflow validation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  status color consistency ...\n    should return consistent colors for all valid statuses ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  status color consistency ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  status text consistency ...\n    should return consistent text for all valid statuses ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  status text consistency ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(8ms)\u001b[0m\n  edge cases ...\n    should handle undefined status gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle null status gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle empty string status gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  edge cases ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  type safety ...\n    should only accept valid AppointmentStatus values ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  type safety ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  business logic validation ...\n    should enforce logical status progression ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should allow cancellation at appropriate stages ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  business logic validation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\nAppointmentUtils ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(13ms)\u001b[0m\n\n\u001b[0m\u001b[32mok\u001b[0m | 1 passed (38 steps) | 0 failed \u001b[0m\u001b[38;5;245m(14ms)\u001b[0m\n\n"
    },
    {
      "suite": "Integration Tests - API",
      "success": false,
      "duration": 6813,
      "output": "\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/appointments.test.ts\u001b[0m\nAppointments API Integration ...\n  POST /api/appointments/create ...\n    should create appointment with valid data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should reject invalid appointment data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle missing required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle malformed JSON ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle room conflicts ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  POST /api/appointments/create ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  GET /api/appointments ...\n    should return list of appointments ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle pagination parameters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle filter parameters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle date range filters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  GET /api/appointments ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  PUT /api/appointments/[id]/update ...\n    should update appointment status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle invalid status ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle non-existent appointment ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle unauthorized update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle invalid appointment data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle concurrent updates ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  PUT /api/appointments/[id]/update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  DELETE /api/appointments/[id]/delete ...\n    should delete appointment successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle non-existent appointment ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle unauthorized deletion ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle appointment with active session ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  DELETE /api/appointments/[id]/delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  Error Handling ...\n    should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle invalid request format ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle missing content type ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle rate limiting ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle service unavailable ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  Error Handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\nAppointments API Integration ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(11ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/auth.test.ts\u001b[0m\nAuth API Integration ...\n  POST /api/auth/login ...\n    should login with valid credentials ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    should reject invalid credentials ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle missing email ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle missing password ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle malformed JSON ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle missing content type ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle rate limiting ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle account lockout ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle inactive user account ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  POST /api/auth/login ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(2ms)\u001b[0m\n  GET /api/auth/check ...\n    should return user data for authenticated request ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle logout flow ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  GET /api/auth/check ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  Error Handling ...\n    should handle session validation errors gracefully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle network errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  Error Handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\nAuth API Integration ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(8ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/patients-real.test.ts\u001b[0m\nPatients API Integration (Real) ...\n  GET /api/patients ...\n    should return empty list when no patients exist ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should return empty list when no patients exist ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(222ms)\u001b[0m\n    should return list of patients when they exist ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should return list of patients when they exist ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(185ms)\u001b[0m\n    should handle unauthorized access ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(181ms)\u001b[0m\n  GET /api/patients ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(588ms)\u001b[0m\n  POST /api/patients ...\n    should create a new patient successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should create a new patient successfully ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(181ms)\u001b[0m\n    should reject patient with missing required fields ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should reject patient with missing required fields ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(183ms)\u001b[0m\n    should reject patient with invalid email format ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should reject patient with invalid email format ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(184ms)\u001b[0m\n    should reject patient with duplicate email ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should reject patient with duplicate email ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(180ms)\u001b[0m\n    should handle malformed JSON ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle malformed JSON ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(182ms)\u001b[0m\n  POST /api/patients ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 5 failed steps) \u001b[0m\u001b[38;5;245m(910ms)\u001b[0m\n  GET /api/patients/[id] ...\n    should return specific patient by ID ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should return specific patient by ID ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(190ms)\u001b[0m\n    should return 404 for non-existent patient ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should return 404 for non-existent patient ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(180ms)\u001b[0m\n  GET /api/patients/[id] ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(370ms)\u001b[0m\n  PUT /api/patients/[id] ...\n    should update patient successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should update patient successfully ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(179ms)\u001b[0m\n    should return 404 when updating non-existent patient ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should return 404 when updating non-existent patient ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(180ms)\u001b[0m\n  PUT /api/patients/[id] ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(359ms)\u001b[0m\n  DELETE /api/patients/[id] ...\n    should delete patient successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should delete patient successfully ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(180ms)\u001b[0m\n    should return 404 when deleting non-existent patient ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should return 404 when deleting non-existent patient ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(180ms)\u001b[0m\n  DELETE /api/patients/[id] ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(360ms)\u001b[0m\n  GET /api/patients/by-psychologist/[email] ...\n    should return patients for specific psychologist ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should return patients for specific psychologist ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(182ms)\u001b[0m\n    should return empty list for psychologist with no patients ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should return empty list for psychologist with no patients ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(180ms)\u001b[0m\n  GET /api/patients/by-psychologist/[email] ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(362ms)\u001b[0m\nPatients API Integration (Real) ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 6 failed steps) \u001b[0m\u001b[38;5;245m(2s)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/patients.test.ts\u001b[0m\nPatients API Integration Tests ...\n  POST /api/patients/create ...\n    should create patient with valid data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should reject invalid patient data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle missing required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle duplicate email ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle malformed JSON ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle rate limiting ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle validation errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  POST /api/patients/create ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  GET /api/patients ...\n    should return list of patients ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle empty patient list ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle server error ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle pagination parameters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle search filters ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  GET /api/patients ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  GET /api/patients/[id] ...\n    should return patient details ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle non-existent patient ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle invalid patient ID format ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  GET /api/patients/[id] ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  PUT /api/patients/[id]/update ...\n    should update patient successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle non-existent patient ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle validation errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle duplicate email ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  PUT /api/patients/[id]/update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(7ms)\u001b[0m\n  DELETE /api/patients/[id]/delete ...\n    should delete patient successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle non-existent patient ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle patient with active appointments ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  DELETE /api/patients/[id]/delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  GET /api/patients/by-psychologist/[email] ...\n    should return patients for psychologist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle non-existent psychologist ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle empty patient list ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  GET /api/patients/by-psychologist/[email] ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(1ms)\u001b[0m\n  Error Handling ...\n    should handle database connection errors ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle invalid request format ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle missing content type ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle service unavailable ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  Error Handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  Data Validation ...\n    should validate email format ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should validate phone format ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should validate date of birth ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should validate required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  Data Validation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  Security Tests ...\n    should handle SQL injection attempts ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle XSS attempts ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n    should handle oversized requests ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\n  Security Tests ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(0ms)\u001b[0m\nPatients API Integration Tests ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(13ms)\u001b[0m\n\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/integration/api/rooms.test.ts\u001b[0m\nRooms API Integration Tests ...\n  GET /api/rooms ...\n    should return list of rooms ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should return list of rooms ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(223ms)\u001b[0m\n    should handle unauthorized access ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(184ms)\u001b[0m\n  GET /api/rooms ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(407ms)\u001b[0m\n  POST /api/rooms/create ...\n    should create room successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should create room successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(183ms)\u001b[0m\n    should validate required fields ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should validate required fields ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(183ms)\u001b[0m\n    should handle unauthorized creation ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle unauthorized creation ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(181ms)\u001b[0m\n  POST /api/rooms/create ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(547ms)\u001b[0m\n  PUT /api/rooms/:id/update ...\n    should update room successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should update room successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(185ms)\u001b[0m\n    should handle non-existent room ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle non-existent room ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(181ms)\u001b[0m\n    should validate update data ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should validate update data ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(184ms)\u001b[0m\n  PUT /api/rooms/:id/update ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(550ms)\u001b[0m\n  POST /api/rooms/:id/toggle-availability ...\n    should toggle room availability successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should toggle room availability successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(195ms)\u001b[0m\n    should handle non-existent room ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle non-existent room ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(184ms)\u001b[0m\n    should handle unauthorized access ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle unauthorized access ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(182ms)\u001b[0m\n  POST /api/rooms/:id/toggle-availability ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(561ms)\u001b[0m\n  DELETE /api/rooms/:id/delete ...\n    should delete room successfully ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should delete room successfully ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(184ms)\u001b[0m\n    should handle non-existent room ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle non-existent room ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(181ms)\u001b[0m\n    should handle unauthorized deletion ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle unauthorized deletion ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(182ms)\u001b[0m\n  DELETE /api/rooms/:id/delete ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(547ms)\u001b[0m\n  Error Handling ...\n    should handle malformed JSON requests ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nError parsing JSON: SyntaxError: Unexpected token 'i', \"invalid json\" is not valid JSON\n    at parse (<anonymous>)\n    at packageData (ext:deno_fetch/22_body.js:421:14)\n    at consumeBody (ext:deno_fetch/22_body.js:274:12)\n    at eventLoopTick (ext:core/01_core.js:178:7)\n    at async Object.handler (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/routes/api/rooms/create.ts:43:18)\n    at async handler (file:///Users/josuepatricio/Documents/horizonte-clinica-deno/routes/_middleware.ts:105:10)\n    at async handler (https://deno.land/x/fresh@1.6.8/src/server/context.ts:293:14)\n    at async mapped (ext:deno_http/00_serve.ts:399:18)\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle malformed JSON requests ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(183ms)\u001b[0m\n    should handle missing content type ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle missing content type ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(181ms)\u001b[0m\n    should handle invalid HTTP methods ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle invalid HTTP methods ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(181ms)\u001b[0m\n    should handle CORS preflight requests ...\n\u001b[0m\u001b[38;5;245m------- post-test output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- post-test output end -----\u001b[0m\n    should handle CORS preflight requests ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(188ms)\u001b[0m\n  Error Handling ... \u001b[0m\u001b[32mok\u001b[0m \u001b[0m\u001b[38;5;245m(733ms)\u001b[0m\nRooms API Integration Tests ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(3s)\u001b[0m\n\n\u001b[0m\u001b[1m\u001b[37m\u001b[41m ERRORS \u001b[0m\n\nPatients API Integration (Real) ... GET /api/patients ... should return empty list when no patients exist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... GET /api/patients ... should return list of patients when they exist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m97\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... POST /api/patients ... should create a new patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   201\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m140\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... POST /api/patients ... should reject patient with missing required fields \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   400\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m161\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... POST /api/patients ... should reject patient with invalid email format \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   400\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m181\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... POST /api/patients ... should reject patient with duplicate email \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   201\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m201\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... POST /api/patients ... should handle malformed JSON \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   400\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m224\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... GET /api/patients/[id] ... should return specific patient by ID \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   201\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m246\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... GET /api/patients/[id] ... should return 404 for non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   404\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m269\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... PUT /api/patients/[id] ... should update patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: TypeError: Cannot read properties of undefined (reading 'id')\n        `/api/patients/${createdPatient.patient.id}`,\n\u001b[0m\u001b[31m                                                ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m300\u001b[0m:\u001b[0m\u001b[33m49\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... PUT /api/patients/[id] ... should return 404 when updating non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   404\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m321\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... DELETE /api/patients/[id] ... should delete patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: TypeError: Cannot read properties of undefined (reading 'id')\n        `/api/patients/${createdPatient.patient.id}`,\n\u001b[0m\u001b[31m                                                ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m347\u001b[0m:\u001b[0m\u001b[33m49\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... DELETE /api/patients/[id] ... should return 404 when deleting non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   404\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m370\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... GET /api/patients/by-psychologist/[email] ... should return patients for specific psychologist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m417\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPatients API Integration (Real) ... GET /api/patients/by-psychologist/[email] ... should return empty list for psychologist with no patients \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/integration/api/patients-real.test.ts\u001b[0m:\u001b[0m\u001b[33m436\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nRooms API Integration Tests \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:191:10\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: Leaks detected:\n  - \"database\" was created during the test, but not cleaned up during the test. Close the resource before the end of the test.\n  - A fetch response body was created during the test, but not consumed during the test. Consume or close the response body `ReadableStream`, e.g `await resp.text()` or `await resp.body.cancel()`.\n\n\u001b[0m\u001b[1m\u001b[37m\u001b[41m FAILURES \u001b[0m\n\nPatients API Integration (Real) ... GET /api/patients ... should return empty list when no patients exist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... GET /api/patients ... should return list of patients when they exist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... POST /api/patients ... should create a new patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... POST /api/patients ... should reject patient with missing required fields \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... POST /api/patients ... should reject patient with invalid email format \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... POST /api/patients ... should reject patient with duplicate email \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... POST /api/patients ... should handle malformed JSON \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... GET /api/patients/[id] ... should return specific patient by ID \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... GET /api/patients/[id] ... should return 404 for non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... PUT /api/patients/[id] ... should update patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... PUT /api/patients/[id] ... should return 404 when updating non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... DELETE /api/patients/[id] ... should delete patient successfully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... DELETE /api/patients/[id] ... should return 404 when deleting non-existent patient \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... GET /api/patients/by-psychologist/[email] ... should return patients for specific psychologist \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPatients API Integration (Real) ... GET /api/patients/by-psychologist/[email] ... should return empty list for psychologist with no patients \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nRooms API Integration Tests \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:191:10\u001b[0m\n\n\u001b[0m\u001b[31mFAILED\u001b[0m | 3 passed (124 steps) | 2 failed (21 steps) \u001b[0m\u001b[38;5;245m(6s)\u001b[0m\n\n\nErrors:\nListening on http://127.0.0.1:52990/\nListening on http://127.0.0.1:52996/\nListening on http://127.0.0.1:52998/\nListening on http://127.0.0.1:53000/\nListening on http://127.0.0.1:53002/\nListening on http://127.0.0.1:53004/\nListening on http://127.0.0.1:53006/\nListening on http://127.0.0.1:53012/\nListening on http://127.0.0.1:53014/\nListening on http://127.0.0.1:53016/\nListening on http://127.0.0.1:53018/\nListening on http://127.0.0.1:53020/\nListening on http://127.0.0.1:53026/\nListening on http://127.0.0.1:53028/\nListening on http://127.0.0.1:53030/\nListening on http://127.0.0.1:53032/\nListening on http://127.0.0.1:53034/\nListening on http://127.0.0.1:53040/\nListening on http://127.0.0.1:53042/\nListening on http://127.0.0.1:53044/\nListening on http://127.0.0.1:53046/\nListening on http://127.0.0.1:53048/\nListening on http://127.0.0.1:53050/\nListening on http://127.0.0.1:53056/\nListening on http://127.0.0.1:53058/\nListening on http://127.0.0.1:53060/\nListening on http://127.0.0.1:53062/\nListening on http://127.0.0.1:53064/\nListening on http://127.0.0.1:53070/\nListening on http://127.0.0.1:53072/\nListening on http://127.0.0.1:53074/\nListening on http://127.0.0.1:53076/\nListening on http://127.0.0.1:53078/\nListening on http://127.0.0.1:53084/\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: Test failed\n"
    },
    {
      "suite": "Performance Tests",
      "success": false,
      "duration": 2774,
      "output": "\u001b[0m\u001b[38;5;245mrunning 1 test from ./tests/performance/load.test.ts\u001b[0m\nPerformance and Load Tests ...\n  Response Time Tests ...\n    should respond to GET /api/patients within acceptable time ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n    should respond to GET /api/patients within acceptable time ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(196ms)\u001b[0m\n    should handle patient creation within acceptable time ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n    should handle patient creation within acceptable time ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(182ms)\u001b[0m\n  Response Time Tests ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(378ms)\u001b[0m\n  Concurrent Request Tests ...\n    should handle multiple concurrent GET requests ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n    should handle multiple concurrent GET requests ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(183ms)\u001b[0m\n    should handle concurrent patient creation without conflicts ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n    should handle concurrent patient creation without conflicts ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(181ms)\u001b[0m\n  Concurrent Request Tests ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 2 failed steps) \u001b[0m\u001b[38;5;245m(364ms)\u001b[0m\n  Memory and Resource Tests ...\n    should handle large patient list without memory issues ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCreating 50 patients in batches of 10...\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n    should handle large patient list without memory issues ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(183ms)\u001b[0m\n  Memory and Resource Tests ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(183ms)\u001b[0m\n  Rate Limiting and Throttling Tests ...\n    should handle rapid successive requests gracefully ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nMaking 20 rapid requests with 50ms intervals...\nâœ… 0 successful, 0 rate limited\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n    should handle rapid successive requests gracefully ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(1s)\u001b[0m\n  Rate Limiting and Throttling Tests ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(1s)\u001b[0m\n  Database Performance Tests ...\n    should handle complex queries efficiently ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\nCreating 10 patients for 3 psychologists...\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n    should handle complex queries efficiently ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(220ms)\u001b[0m\n  Database Performance Tests ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(220ms)\u001b[0m\n  Error Recovery Tests ...\n    should recover gracefully from invalid requests ...\n\u001b[0m\u001b[38;5;245m------- output -------\u001b[0m\nUsing snapshot found at \u001b[36m/Users/josuepatricio/Documents/horizonte-clinica-deno/_fresh\u001b[39m\n\u001b[0m\u001b[38;5;245m----- output end -----\u001b[0m\n    should recover gracefully from invalid requests ... \u001b[0m\u001b[31mFAILED\u001b[0m \u001b[0m\u001b[38;5;245m(189ms)\u001b[0m\n  Error Recovery Tests ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 1 failed step) \u001b[0m\u001b[38;5;245m(189ms)\u001b[0m\nPerformance and Load Tests ... \u001b[0m\u001b[31mFAILED\u001b[0m (due to 6 failed steps) \u001b[0m\u001b[38;5;245m(2s)\u001b[0m\n\n\u001b[0m\u001b[1m\u001b[37m\u001b[41m ERRORS \u001b[0m\n\nPerformance and Load Tests ... Response Time Tests ... should respond to GET /api/patients within acceptable time \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m48\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPerformance and Load Tests ... Response Time Tests ... should handle patient creation within acceptable time \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   201\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m75\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPerformance and Load Tests ... Concurrent Request Tests ... should handle multiple concurrent GET requests \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal: Request 0 failed\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m106\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mArray.forEach\u001b[0m (\u001b[0m\u001b[36m<anonymous>\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m105\u001b[0m:\u001b[0m\u001b[33m17\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPerformance and Load Tests ... Concurrent Request Tests ... should handle concurrent patient creation without conflicts \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal: Patient creation 0 failed\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   201\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m149\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mArray.forEach\u001b[0m (\u001b[0m\u001b[36m<anonymous>\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m148\u001b[0m:\u001b[0m\u001b[33m17\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPerformance and Load Tests ... Memory and Resource Tests ... should handle large patient list without memory issues \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal: Batch 0, patient 0 creation failed\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   201\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m202\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mArray.forEach\u001b[0m (\u001b[0m\u001b[36m<anonymous>\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m201\u001b[0m:\u001b[0m\u001b[33m24\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPerformance and Load Tests ... Rate Limiting and Throttling Tests ... should handle rapid successive requests gracefully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: No successful responses received\n    throw new AssertionError(msg);\n\u001b[0m\u001b[31m          ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assert\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert.ts\u001b[0m:\u001b[0m\u001b[33m17\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massert\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m608\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m280\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPerformance and Load Tests ... Database Performance Tests ... should handle complex queries efficiently \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal.\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m328\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\nPerformance and Load Tests ... Error Recovery Tests ... should recover gracefully from invalid requests \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: AssertionError: Values are not equal: Server not responding after invalid request 0\n\n\n    \u001b[90m\u001b[1m[Diff]\u001b[22m\u001b[39m \u001b[31m\u001b[1mActual\u001b[22m\u001b[39m / \u001b[32m\u001b[1mExpected\u001b[22m\u001b[39m\n\n\n\u001b[31m\u001b[1m-   401\u001b[22m\u001b[39m\n\u001b[32m\u001b[1m+   200\u001b[22m\u001b[39m\n\n  throw new AssertionError(message);\n\u001b[0m\u001b[31m        ^\u001b[0m\n    at \u001b[0m\u001b[1m\u001b[3mModule.assertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/assert/assert_equals.ts\u001b[0m:\u001b[0m\u001b[33m52\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3massertEquals\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/asserts.ts\u001b[0m:\u001b[0m\u001b[33m101\u001b[0m:\u001b[0m\u001b[33m11\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3mObject.<anonymous>\u001b[0m (\u001b[0m\u001b[36mfile:///Users/josuepatricio/Documents/horizonte-clinica-deno/tests/performance/load.test.ts\u001b[0m:\u001b[0m\u001b[33m386\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at \u001b[0m\u001b[1m\u001b[3meventLoopTick\u001b[0m (\u001b[0m\u001b[36mext:core/01_core.js\u001b[0m:\u001b[0m\u001b[33m178\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m358\u001b[0m:\u001b[0m\u001b[33m7\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mTestSuiteInternal.runTest\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m346\u001b[0m:\u001b[0m\u001b[33m9\u001b[0m)\n    at async \u001b[0m\u001b[1m\u001b[3mfn\u001b[0m (\u001b[0m\u001b[36mhttps://deno.land/std@0.216.0/testing/_test_suite.ts\u001b[0m:\u001b[0m\u001b[33m316\u001b[0m:\u001b[0m\u001b[33m13\u001b[0m)\n\n\u001b[0m\u001b[1m\u001b[37m\u001b[41m FAILURES \u001b[0m\n\nPerformance and Load Tests ... Response Time Tests ... should respond to GET /api/patients within acceptable time \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPerformance and Load Tests ... Response Time Tests ... should handle patient creation within acceptable time \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPerformance and Load Tests ... Concurrent Request Tests ... should handle multiple concurrent GET requests \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPerformance and Load Tests ... Concurrent Request Tests ... should handle concurrent patient creation without conflicts \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPerformance and Load Tests ... Memory and Resource Tests ... should handle large patient list without memory issues \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPerformance and Load Tests ... Rate Limiting and Throttling Tests ... should handle rapid successive requests gracefully \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPerformance and Load Tests ... Database Performance Tests ... should handle complex queries efficiently \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\nPerformance and Load Tests ... Error Recovery Tests ... should recover gracefully from invalid requests \u001b[0m\u001b[38;5;245m=> https://deno.land/std@0.216.0/testing/_test_suite.ts:323:15\u001b[0m\n\n\u001b[0m\u001b[31mFAILED\u001b[0m | 0 passed | 1 failed (14 steps) \u001b[0m\u001b[38;5;245m(2s)\u001b[0m\n\n\nErrors:\nListening on http://127.0.0.1:53086/\nListening on http://127.0.0.1:53088/\nListening on http://127.0.0.1:53090/\nListening on http://127.0.0.1:53101/\nListening on http://127.0.0.1:53111/\nListening on http://127.0.0.1:53122/\nListening on http://127.0.0.1:53128/\nListening on http://127.0.0.1:53130/\n\u001b[0m\u001b[1m\u001b[31merror\u001b[0m: Test failed\n"
    }
  ],
  "summary": {
    "totalSuites": 5,
    "successfulSuites": 2,
    "failedSuites": 3,
    "totalDuration": 10417
  }
}